// Entity RelationShip Model
// entrel.js, v1.0
// Chen Style
// Copyright (c)2018 Erdinç Uzun
// Distributed under MIT license

function FlatLine(t,i,e,s,h,r,l,o,a,_){Line.call(this,t,i,e,s,h,r,l,o,a,!1),this.Draw=function(){if(null==t||null==i)return"";var e=this.selection1[0]+","+this.selection1[1]+" "+this.selection2[0]+","+this.selection2[1];if(this.LinesData=e,e=polyline_start+' "'+e+'" '+polyline_end.replace("black",this.stroke_color),this.arrow||(e=e.replace('marker-end="url(#arrow)"',"")),this.text.length>0){var s=this.findLongestLinePoint();e+=writeText(this.text,this.text_size,"normal",s[0]+3,s[1]-10,30,s[2],this.text_color)}var h='<g id="'+this.ID+'" ';return onclick_enabled&&(h+='onclick="doClick_Object(evt)" '),h+='style="cursor:pointer">',h+=e,h+="</g>"}}function Entity(t,i,e,s,h,r,l,o,a,_,n){Process.call(this,t,i,e,s,r,o,a,_,n),this.Name="Entity",this.attributes=[],this.attributes=void 0===h||null==h?[]:"string"==typeof h?[h]:h,void 0!==l&&null!=l||(l=!1),this.Draw=function(){_stroke_width=2,temp='<g id="'+this.ID+'" ',onclick_enabled&&(temp+='onclick="doClick_Object(evt)" '),temp+='style="cursor:pointer">',l&&(_stroke_width=1,temp+='<rect x="'+(this.start_x-2)+'" y="'+(this.start_y-2)+'" width="'+(this.width+4)+'" height="'+(this.height+4)+'" fill-opacity="0.0" style="fill:'+this.fill_color+";stroke:"+this.stroke_color+";stroke-width:"+_stroke_width+'" />'),temp+='<rect x="'+this.start_x+'" y="'+this.start_y+'" width="'+this.width+'" height="'+this.height+'" fill-opacity="0.0" style="fill:'+this.fill_color+";stroke:"+this.stroke_color+";stroke-width:"+_stroke_width+'" />',this.text.length>0&&(temp+=writeText(this.text,this.text_size,"normal",this.middle_x,this.middle_y,this.height,"center",n));var t=this.attributes.length,i=(this.width,this.start_x-65*e),s=this.start_y-60*e;this.probable_x_y[0][0]=this.start_x;for(var h=0;h<t;h++){if(void 0!==this.attributes[h]&&null!=this.attributes[h]&&""!=this.attributes[h]){var r=this.attributes[h],o=!1,d=!1,c=!1;r.includes("(")&&(r.includes("PK")&&(o=!0),r.includes("DE")&&(d=!0),r.includes("MV")&&(c=!0),r=r.replace(r.substring(r.lastIndexOf("("),r.lastIndexOf(")")+1),""));var x=new theAttribute(i,s,this.size,r,this.text_size,null,a,_,n,o,d,c);x.ID="Object_"+(object_array.length+1),object_array.push(x),temp+=x.Draw()}if(h<=3){if(this.probable_x_y[0][0]+=25*e,void 0!==this.attributes[h]&&null!=this.attributes[h]&&""!=this.attributes[h]){var y=new FlatLine(this,x,0,1);temp+=y.Draw()}i+=85*e,3==h&&(i=this.start_x-60*e,s=this.start_y+this.height+60*e,this.probable_x_y[1][0]=this.start_x)}else{if(this.probable_x_y[1][0]+=25*e,void 0!==this.attributes[h]&&null!=this.attributes[h]&&""!=this.attributes[h]){y=new FlatLine(this,x,1,0);temp+=y.Draw()}i+=85*e}}return this.probable_x_y[0][0]=this.middle_x,this.probable_x_y[1][0]=this.middle_x,temp+="</g>",temp}}function theAttribute(t,i,e,s,h,r,l,o,a,_,n,d){Process.call(this,t,i,e,s,h,r,l,o,a),this.Name="Attribute",this.rx=40*e,this.ry=20*e,void 0!==n&&null!=n||(n=!1),void 0!==d&&null!=d||(d=!1),this.probable_x_y[0][0]=this.middle_x,this.probable_x_y[0][1]=this.middle_y-this.height/2+5*e,this.probable_x_y[1][0]=this.middle_x,this.probable_x_y[1][1]=this.middle_y+this.height/2-5*e,this.Draw=function(){return temp="",_stroke_width=2,d&&(_stroke_width=1,temp+='<ellipse cx="'+this.middle_x+'" cy="'+this.middle_y+'" rx="'+(this.rx+2)+'" ry="'+(this.ry+2)+'" fill-opacity="0.0" style="fill:'+this.fill_color+";stroke:"+this.stroke_color+";stroke-width:"+_stroke_width+'"',n&&(temp+=' stroke-dasharray="5, 5"'),temp+=" />"),temp+='<ellipse cx="'+this.middle_x+'" cy="'+this.middle_y+'" rx="'+this.rx+'" ry="'+this.ry+'" style="fill:'+this.fill_color+";stroke:"+this.stroke_color+";stroke-width:"+_stroke_width+'"',n&&(temp+=' stroke-dasharray="5, 5"'),temp+=" />",this.text.length>0&&(temp+=writeText(this.text,this.text_size,"normal",this.middle_x,this.middle_y,this.height,"center",a,_)),temp}}